<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <title>NO MEAN'S SKY ‚Äì Planet Archive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 30px 14px;
      font-family: "Orbitron", system-ui, sans-serif;
      background: radial-gradient(circle at 15% 0, #15233e, transparent 55%),
                  radial-gradient(circle at 85% 100%, #091326, transparent 55%),
                  #020513;
      color: #e5f8ff;
      display: flex;
      justify-content: center;
    }
    .shell {
      width: min(1100px, 100%);
    }
    .back-link {
      display:inline-block;
      margin-bottom:10px;
      font-size:11px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      color:#7fdcff;
      text-decoration:none;
      border-bottom:1px dashed rgba(127,220,255,0.7);
      padding-bottom:2px;
    }
    .back-link:hover {
      color:#fff;
      border-color:#fff;
    }
    .title {
      text-align: center;
      font-size: 22px;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: #4cd8ff;
      text-shadow: 0 0 14px rgba(80,220,255,0.9);
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(170,210,255,0.75);
      margin-bottom: 18px;
    }
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 18px;
    }
    .card {
      background: rgba(4, 10, 26, 0.95);
      border-radius: 18px;
      border: 1px solid rgba(0,200,255,0.55);
      box-shadow: 0 0 22px rgba(0,200,255,0.35);
      padding: 14px 14px 16px;
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content:"";
      position:absolute;
      inset:10px;
      border-radius:14px;
      border:1px dashed rgba(0,200,255,0.28);
      pointer-events:none;
    }
    .planet-name {
      font-size:15px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      color:#ffffff;
      margin-bottom:2px;
    }
    .badge-line {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      margin-bottom:6px;
      font-size:10px;
      letter-spacing:0.12em;
      text-transform:uppercase;
      color:rgba(170,210,255,0.8);
    }
    .badge {
      border-radius:999px;
      padding:2px 8px;
      border:1px solid rgba(255,180,120,0.7);
      color:#ffd7b3;
    }
    .row {
      font-size:11px;
      letter-spacing:0.08em;
      text-transform:uppercase;
      color:rgba(180,215,255,0.9);
      margin-bottom:3px;
    }
    .row span {
      color:rgba(130,190,255,0.9);
    }
    .desc {
      margin-top:6px;
      font-size:11px;
      line-height:1.4;
      color:rgba(210,230,255,0.9);
    }

    .thumb-area {
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .thumb {
      width:70px;
      height:70px;
      border-radius:10px;
      border:1px solid rgba(0,200,255,0.7);
      overflow:hidden;
      cursor:pointer;
      position:relative;
    }
    .thumb img {
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .thumb-count {
      position:absolute;
      bottom:2px;
      right:4px;
      font-size:9px;
      background:rgba(0,0,0,0.7);
      padding:1px 4px;
      border-radius:999px;
      color:#cdefff;
    }

    .empty {
      margin-top:40px;
      text-align:center;
      font-size:12px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      color:rgba(150,190,230,0.7);
    }

    /* OVERLAY –∑–∞ —Ä–∞–∑–ø—ä–≤–∞–Ω–µ –Ω–∞ —Å–Ω–∏–º–∫–∞—Ç–∞ */
    .img-overlay {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:9999;
    }
    .img-overlay-bg {
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.85);
    }
    .img-overlay-img {
      position:relative;
      max-width:90vw;
      max-height:90vh;
      border-radius:18px;
      border:1px solid rgba(0,200,255,0.9);
      box-shadow:0 0 35px rgba(0,200,255,0.7);
    }
  </style>
</head>

<body>
  <div class="shell">
    <a href="index.html" class="back-link">‚üµ Back to Ship Log Home</a>

    <div class="title">Planet Archive</div>
    <div class="subtitle">Local log of all explored worlds ‚Äì data + visual journal</div>

    <div id="cards" class="cards"></div>
    <div id="empty" class="empty" style="display:none;">
      –ù—è–º–∞ –∑–∞–ø–∏—Å–∞–Ω–∏ –ø–ª–∞–Ω–µ—Ç–∏ –Ω–∞ —Ç–æ–∑–∏ –∫–æ–º–ø—é—Ç—ä—Ä. <br>
      –û—Ç–≤–æ—Ä–∏ ADMIN –ø–∞–Ω–µ–ª–∞ –∏ –¥–æ–±–∞–≤–∏ –ø—ä—Ä–≤–∞—Ç–∞ —Å–∏ –ø–ª–∞–Ω–µ—Ç–∞. üåå
    </div>
  </div>

  <!-- OVERLAY –∑–∞ —Å–Ω–∏–º–∫–∏—Ç–µ -->
  <div id="imgOverlay" class="img-overlay" onclick="closeOverlay()">
    <div class="img-overlay-bg"></div>
    <img id="overlayImg" class="img-overlay-img" alt="Planet journal photo">
  </div>

<script>
  const STORAGE_KEY = "nms_planets_archive_v1";

  function loadPlanets() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return [];
      return JSON.parse(raw);
    } catch (e) {
      console.warn("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —á–µ—Ç–µ–Ω–µ –Ω–∞ localStorage:", e);
      return [];
    }
  }

  function formatDate(iso) {
    if (!iso) return "";
    const d = new Date(iso);
    return d.toLocaleString("bg-BG");
  }

  function showImage(src) {
    const overlay = document.getElementById("imgOverlay");
    const img = document.getElementById("overlayImg");
    img.src = src;
    overlay.style.display = "flex";
  }

  function closeOverlay() {
    const overlay = document.getElementById("imgOverlay");
    const img = document.getElementById("overlayImg");
    overlay.style.display = "none";
    img.src = "";
  }

  function render() {
    const cardsEl = document.getElementById("cards");
    const emptyEl = document.getElementById("empty");
    const planets = loadPlanets();

    cardsEl.innerHTML = "";

    if (!planets.length) {
      emptyEl.style.display = "block";
      return;
    }
    emptyEl.style.display = "none";

    planets
      .slice()
      .sort((a,b) => (b.createdAt || "").localeCompare(a.createdAt || ""))
      .forEach(p => {
        const card = document.createElement("div");
        card.className = "card";

        const images = Array.isArray(p.images) ? p.images : [];
        const hasImages = images.length > 0;

        let thumbsHtml = "";
        if (hasImages) {
          // –ø–æ–∫–∞–∑–≤–∞–º–µ –¥–æ 3 –º–∏–Ω–∏–∞—Ç—é—Ä–∏
          const maxThumbs = Math.min(images.length, 3);
          const thumbs = images.slice(0, maxThumbs);
          thumbsHtml = `
            <div class="thumb-area">
              ${thumbs.map((src, idx) => `
                <div class="thumb" onclick="showImage('${src}')">
                  <img src="${src}" alt="journal image ${idx+1}">
                  <span class="thumb-count">#${idx+1}${images.length > maxThumbs && idx === maxThumbs-1 ? " +" + (images.length - maxThumbs) : ""}</span>
                </div>
              `).join("")}
            </div>
          `;
        }

        card.innerHTML = `
          <div class="planet-name">${p.name || "UNKNOWN"}</div>
          <div class="badge-line">
            <span>${p.galaxy || "Unknown galaxy"} ‚Ä¢ ${p.system || "Unknown system"}</span>
            <span class="badge">${p.biome || "Unknown biome"}</span>
          </div>
          <div class="row">Weather: <span>${p.weather || "-"}</span></div>
          <div class="row">Temperature: <span>${p.temp || "-"}</span></div>
          <div class="row">Hazards: <span>${p.hazard || "-"}</span></div>
          <div class="row">Sentinels: <span>${p.sentinels || "-"}</span></div>
          <div class="row">Fauna: <span>${p.fauna || "-"}</span></div>
          <div class="row">Flora: <span>${p.flora || "-"}</span></div>
          <div class="row">Resources: <span>${p.resources || "-"}</span></div>
          <div class="row">Log date: <span>${formatDate(p.createdAt)}</span></div>
          <div class="desc">${(p.desc || "").replace(/\n/g,"<br>")}</div>
          ${thumbsHtml}
        `;

        cardsEl.appendChild(card);
      });
  }

  render();
</script>

</body>
</html>
